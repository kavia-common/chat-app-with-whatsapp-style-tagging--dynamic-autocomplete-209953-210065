{"is_source_file": true, "format": "TypeScript", "description": "This file defines a custom React hook 'useTagging' that enables WhatsApp-style tagging functionality within a contenteditable element. It manages trigger detection for '@' or '#' symbols, caret position tracking, suggestion fetching, and tag insertion logic, integrating with a Redux store.", "external_files": ["react", "react-redux", "@/store", "@/types"], "external_methods": ["useDispatch", "fetchTags", "setAnchorPos", "setQuery", "setTrigger", "setVisible", "show", "hide"], "published": ["useTagging"], "classes": [], "methods": [{"name": "export function useTagging(editorRef: React.RefObject<HTMLElement | HTMLDivElement | null>) { useTagging", "description": "React hook to enable tagging with '@' or '#' in a contenteditable element, managing detection of trigger characters, caret positioning, and inserting tags.", "scope": "", "scopeKind": ""}, {"name": "getCaretClientRect", "description": "Calculates the current caret position relative to the viewport, returning x and y coordinates."}, {"name": "detectTrigger", "description": "Detects if the current selection is preceded by '@' or '#' and triggers suggestion display and fetching."}, {"name": "insertTagAtCaret", "description": "Inserts a tag element at the current caret position, removing the trigger word before the caret."}], "calls": ["useDispatch", "dispatch(show)", "dispatch(fetchTags)", "dispatch(setTrigger)", "dispatch(setQuery)", "dispatch(setVisible)", "dispatch(setAnchorPos)", "window.getSelection", "window.getSelection().getRangeAt", "range.getBoundingClientRect", "range.cloneRange", "domNode.textContent", "domNode.nodeType", "document.createTextNode", "range.insertNode", "sel.removeAllRanges", "sel.addRange"], "search-terms": ["useTagging", "contenteditable tagging", "React hook tagging", "trigger detection '@#'", "insert tag in contenteditable"], "state": 2, "file_id": 25, "knowledge_revision": 64, "git_revision": "6afdd3d461c90f1078d72856a655354a3eb9ad5c", "revision_history": [{"59": ""}, {"64": "6afdd3d461c90f1078d72856a655354a3eb9ad5c"}], "ctags": [{"_type": "tag", "name": "child", "path": "/home/kavia/workspace/code-generation/chat-app-with-whatsapp-style-tagging--dynamic-autocomplete-209953-210065/FrontendWebApplication/src/hooks/useTagging.ts", "pattern": "/^      const child = el.childNodes[focusOffset - 1] as ChildNode | null;$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "container", "path": "/home/kavia/workspace/code-generation/chat-app-with-whatsapp-style-tagging--dynamic-autocomplete-209953-210065/FrontendWebApplication/src/hooks/useTagging.ts", "pattern": "/^          const container = range.startContainer;$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "currentTrigger", "path": "/home/kavia/workspace/code-generation/chat-app-with-whatsapp-style-tagging--dynamic-autocomplete-209953-210065/FrontendWebApplication/src/hooks/useTagging.ts", "pattern": "/^  const currentTrigger = useRef<TagTrigger | null>(null);$/", "language": "TypeScript", "kind": "constant", "scope": "useTagging", "scopeKind": "function"}, {"_type": "tag", "name": "detectTrigger", "path": "/home/kavia/workspace/code-generation/chat-app-with-whatsapp-style-tagging--dynamic-autocomplete-209953-210065/FrontendWebApplication/src/hooks/useTagging.ts", "pattern": "/^  const detectTrigger = useCallback(() => {$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "dispatch", "path": "/home/kavia/workspace/code-generation/chat-app-with-whatsapp-style-tagging--dynamic-autocomplete-209953-210065/FrontendWebApplication/src/hooks/useTagging.ts", "pattern": "/^  const dispatch = useDispatch<AppDispatch>();$/", "language": "TypeScript", "kind": "constant", "scope": "useTagging", "scopeKind": "function"}, {"_type": "tag", "name": "el", "path": "/home/kavia/workspace/code-generation/chat-app-with-whatsapp-style-tagging--dynamic-autocomplete-209953-210065/FrontendWebApplication/src/hooks/useTagging.ts", "pattern": "/^      const el = node as HTMLElement;$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "el", "path": "/home/kavia/workspace/code-generation/chat-app-with-whatsapp-style-tagging--dynamic-autocomplete-209953-210065/FrontendWebApplication/src/hooks/useTagging.ts", "pattern": "/^    const el = editorRef.current;$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "focusOffset", "path": "/home/kavia/workspace/code-generation/chat-app-with-whatsapp-style-tagging--dynamic-autocomplete-209953-210065/FrontendWebApplication/src/hooks/useTagging.ts", "pattern": "/^      const child = el.childNodes[focusOffset - 1] as ChildNode | null;$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "focusOffset", "path": "/home/kavia/workspace/code-generation/chat-app-with-whatsapp-style-tagging--dynamic-autocomplete-209953-210065/FrontendWebApplication/src/hooks/useTagging.ts", "pattern": "/^      const focusOffset = sel.anchorOffset;$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "fullTextBefore", "path": "/home/kavia/workspace/code-generation/chat-app-with-whatsapp-style-tagging--dynamic-autocomplete-209953-210065/FrontendWebApplication/src/hooks/useTagging.ts", "pattern": "/^      const fullTextBefore = wordRange.toString();$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "getCaretClientRect", "path": "/home/kavia/workspace/code-generation/chat-app-with-whatsapp-style-tagging--dynamic-autocomplete-209953-210065/FrontendWebApplication/src/hooks/useTagging.ts", "pattern": "/^  const getCaretClientRect = useCallback((): { x: number; y: number } | null => {$/", "language": "TypeScript", "kind": "constant", "scope": "useTagging", "scopeKind": "function"}, {"_type": "tag", "name": "insertTagAtCaret", "path": "/home/kavia/workspace/code-generation/chat-app-with-whatsapp-style-tagging--dynamic-autocomplete-209953-210065/FrontendWebApplication/src/hooks/useTagging.ts", "pattern": "/^  const insertTagAtCaret = useCallback($/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "match", "path": "/home/kavia/workspace/code-generation/chat-app-with-whatsapp-style-tagging--dynamic-autocomplete-209953-210065/FrontendWebApplication/src/hooks/useTagging.ts", "pattern": "/^    const match = \\/(^|\\\\s)([@#])([^\\\\s@#]*)$\\/.exec(textBefore);$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "newRange", "path": "/home/kavia/workspace/code-generation/chat-app-with-whatsapp-style-tagging--dynamic-autocomplete-209953-210065/FrontendWebApplication/src/hooks/useTagging.ts", "pattern": "/^      const newRange = document.createRange();$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "node", "path": "/home/kavia/workspace/code-generation/chat-app-with-whatsapp-style-tagging--dynamic-autocomplete-209953-210065/FrontendWebApplication/src/hooks/useTagging.ts", "pattern": "/^    const node = sel.anchorNode;$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "onInput", "path": "/home/kavia/workspace/code-generation/chat-app-with-whatsapp-style-tagging--dynamic-autocomplete-209953-210065/FrontendWebApplication/src/hooks/useTagging.ts", "pattern": "/^  const onInput = useCallback(() => {$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "onKeyUp", "path": "/home/kavia/workspace/code-generation/chat-app-with-whatsapp-style-tagging--dynamic-autocomplete-209953-210065/FrontendWebApplication/src/hooks/useTagging.ts", "pattern": "/^  const onKeyUp = useCallback(() => {$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "pos", "path": "/home/kavia/workspace/code-generation/chat-app-with-whatsapp-style-tagging--dynamic-autocomplete-209953-210065/FrontendWebApplication/src/hooks/useTagging.ts", "pattern": "/^      const pos = getCaretClientRect();$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "query", "path": "/home/kavia/workspace/code-generation/chat-app-with-whatsapp-style-tagging--dynamic-autocomplete-209953-210065/FrontendWebApplication/src/hooks/useTagging.ts", "pattern": "/^      const query = match[3] || \"\";$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "range", "path": "/home/kavia/workspace/code-generation/chat-app-with-whatsapp-style-tagging--dynamic-autocomplete-209953-210065/FrontendWebApplication/src/hooks/useTagging.ts", "pattern": "/^      const range = sel.getRangeAt(0);$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "range", "path": "/home/kavia/workspace/code-generation/chat-app-with-whatsapp-style-tagging--dynamic-autocomplete-209953-210065/FrontendWebApplication/src/hooks/useTagging.ts", "pattern": "/^    const range = sel.getRangeAt(0).cloneRange();$/", "language": "TypeScript", "kind": "constant", "scope": "useTagging", "scopeKind": "function"}, {"_type": "tag", "name": "rect", "path": "/home/kavia/workspace/code-generation/chat-app-with-whatsapp-style-tagging--dynamic-autocomplete-209953-210065/FrontendWebApplication/src/hooks/useTagging.ts", "pattern": "/^    const rect = range.getBoundingClientRect();$/", "language": "TypeScript", "kind": "constant", "scope": "useTagging", "scopeKind": "function"}, {"_type": "tag", "name": "remaining", "path": "/home/kavia/workspace/code-generation/chat-app-with-whatsapp-style-tagging--dynamic-autocomplete-209953-210065/FrontendWebApplication/src/hooks/useTagging.ts", "pattern": "/^        let remaining = triggerMatch[0].length;$/", "language": "TypeScript", "kind": "variable"}, {"_type": "tag", "name": "removeCount", "path": "/home/kavia/workspace/code-generation/chat-app-with-whatsapp-style-tagging--dynamic-autocomplete-209953-210065/FrontendWebApplication/src/hooks/useTagging.ts", "pattern": "/^            const removeCount = Math.min(remaining, range.startOffset);$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "removeCount", "path": "/home/kavia/workspace/code-generation/chat-app-with-whatsapp-style-tagging--dynamic-autocomplete-209953-210065/FrontendWebApplication/src/hooks/useTagging.ts", "pattern": "/^            const start = range.startOffset - removeCount;$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "space1", "path": "/home/kavia/workspace/code-generation/chat-app-with-whatsapp-style-tagging--dynamic-autocomplete-209953-210065/FrontendWebApplication/src/hooks/useTagging.ts", "pattern": "/^      const space1 = document.createTextNode(\" \");$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "space2", "path": "/home/kavia/workspace/code-generation/chat-app-with-whatsapp-style-tagging--dynamic-autocomplete-209953-210065/FrontendWebApplication/src/hooks/useTagging.ts", "pattern": "/^      const space2 = document.createTextNode(\" \");$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "start", "path": "/home/kavia/workspace/code-generation/chat-app-with-whatsapp-style-tagging--dynamic-autocomplete-209953-210065/FrontendWebApplication/src/hooks/useTagging.ts", "pattern": "/^            const start = range.startOffset - removeCount;$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "symbol", "path": "/home/kavia/workspace/code-generation/chat-app-with-whatsapp-style-tagging--dynamic-autocomplete-209953-210065/FrontendWebApplication/src/hooks/useTagging.ts", "pattern": "/^      const symbol = match[2] as TagTrigger;$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "t", "path": "/home/kavia/workspace/code-generation/chat-app-with-whatsapp-style-tagging--dynamic-autocomplete-209953-210065/FrontendWebApplication/src/hooks/useTagging.ts", "pattern": "/^      const t = node.textContent || \"\";$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "textBefore", "path": "/home/kavia/workspace/code-generation/chat-app-with-whatsapp-style-tagging--dynamic-autocomplete-209953-210065/FrontendWebApplication/src/hooks/useTagging.ts", "pattern": "/^    let textBefore = \"\";$/", "language": "TypeScript", "kind": "variable"}, {"_type": "tag", "name": "tnode", "path": "/home/kavia/workspace/code-generation/chat-app-with-whatsapp-style-tagging--dynamic-autocomplete-209953-210065/FrontendWebApplication/src/hooks/useTagging.ts", "pattern": "/^            const tnode = container as Text;$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "triggerMatch", "path": "/home/kavia/workspace/code-generation/chat-app-with-whatsapp-style-tagging--dynamic-autocomplete-209953-210065/FrontendWebApplication/src/hooks/useTagging.ts", "pattern": "/^      const triggerMatch = \\/([@#])([^\\\\s@#]*)$\\/.exec(fullTextBefore);$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "useTagging", "path": "/home/kavia/workspace/code-generation/chat-app-with-whatsapp-style-tagging--dynamic-autocomplete-209953-210065/FrontendWebApplication/src/hooks/useTagging.ts", "pattern": "/^export function useTagging(editorRef: React.RefObject<HTMLElement | HTMLDivElement | null>) {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "wordRange", "path": "/home/kavia/workspace/code-generation/chat-app-with-whatsapp-style-tagging--dynamic-autocomplete-209953-210065/FrontendWebApplication/src/hooks/useTagging.ts", "pattern": "/^      const wordRange = range.cloneRange();$/", "language": "TypeScript", "kind": "constant"}], "hash": "e138bde5e440a3caea6a287cf40b8dd8", "format-version": 4, "code-base-name": "FrontendWebApplication", "filename": "FrontendWebApplication/src/hooks/useTagging.ts", "fields": [{"name": "let remaining = triggerMatch[0].length;", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "let textBefore = \"\";", "scope": "", "scopeKind": "", "description": "unavailable"}]}